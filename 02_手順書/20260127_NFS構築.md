# 概要
### 1. FNSサーバ を構築する(DNSサーバ側の手順)
### 2. uid の調整(全員)
### 3. FNSクライアント を構築する(メールサーバ側の手順)
### 4. NFSサーバ でメール確認
<br/>
<br/>



# 1. FNSサーバ を構築する
### メールユーザの作成
```bash
# ユーザ作成
useradd teamc -g mail -M -K MAIL_DIR=/dev/null -s /sbin/nologin

# パスワード設定
passwd teamc
```
</br>

### 共有ディレクトリの作成
```bash
# ディレクトリ作成
mkdir /teamc_parent

# 権限付与
chown -R teamc:mail /teamc_parent
chmod -R 755 /teamc_parent
```
</br>

### exportsの設定
```bash
# ファイル編集
vi /etc/exports
-----------------
/teamc_parent 172.31.0.0/16(rw,no_root_squash)
※ rw → 書き込み、読み込み権限
※ no_root_squash → root権限を付与
-----------------

# 起動
systemctl restart nfs-server

# 自動起動
systemctl enable nfs-server

# 設定反映
exportfs -a
```
</br>
</br>
</br>


# 2. uid の調整
### uid の確認
```bash
# uid 確認
id teamc

# uid(1001)の確認
getent passwd 1001

# サービス停止
systemctl stop postfix
systemctl stop dovecot

# uid(1001)を空ける
usermod -u 1003 kurosawa

# uid(1001)の確認
getent passwd 1001

# メールユーザのuidを変更する
usermod -u 1001 teamc
※　uid 全サーバでを合わせる必要がある。

# サービス再起動
systemctl restart postfix
systemctl restart dovecot

# uid 確認
id teamc
```
</br>
</br>
</br>


# 3. FNSクライアント を構築する
### NFSマウント設定とマウント
```bash
# マウントポイントの権限を合わせる
chmod -R 755 /var/spool/mail/teamc

# ファイル編集
vi /etc/fstab
-----------------
# 末尾に追記
172.31.47.37:/share_teamc /var/spool/mail nfs4 defaults 0 0
-----------------

# マウント
mount /var/spool/mail

# アンマウント
# umount /var/spool/mail

# マウント確認
df

```
</br>
</br>
</br>


# 4. NFSサーバでメール確認
### Outlook でメール送信
### サーバ側で確認
```bash
ls -l /teamc_parent
```
</br>
</br>
</br>
