# 目的
### EC2を2台構成で構築し、各EC2間で通信をして、wordpressが動作するようにする。
</br>
</br>

# 構成
```bash
[ EC2① ] Web + WordPress
   |
   | 3306/TCP
   v
[ EC2② ] MariaDB（DB専用）
```
</br>
</br>

# 手順
## `情報の定義`
【前提】転送元のshファイルがダウンロードフォルダに格納してあること。
```bash
# 認証キー
KEY="$HOME/.ssh/CL_kurosawa_key.pem"

# IPアドレス(適宜変更すること)
EC2_IP_DB="54.214.89.122"
EC2_IP_WEB="54.214.89.122"

# shファイルパス(転送元)
SH_FILE_DB="$HOME/Downloads/db_server_setup.sh"
SH_FILE_WEB="$HOME/Downloads/web_server_setup.sh"
```
</br>
</br>






## `DBサーバ構築`
### shファイル転送
```bash
# DBサーバへのファイル転送
scp -i "$KEY" "$SH_FILE_DB" ec2-user@"$EC2_IP_DB":/home/ec2-user/
```


### DBサーバに接続
```bash
ssh -i "$KEY" ec2-user@"$EC2_IP_DB"
```


### DBサーバのセキュリティグループにインバウンドルールを追加
```bash
Type: MYSQL/Aurora
Port: 3306
Protocol: TCP
Source: {WEBサーバのセキュリティグループ}
```


### DBサーバの構築
```bash
# 権限変更
chmod 755 db_server_setup.sh

# シェル実行
./db_server_setup.sh
```
</br>
</br>





## `WEBサーバ構築`
### shファイル転送
```bash
# WEBサーバへのファイル転送
scp -i "$KEY" "$SH_FILE" ec2-user@"$EC2_IP_WEB":/home/ec2-user/
```

### WEBサーバに接続
```bash
ssh -i "$KEY" ec2-user@"$EC2_IP_WEB"
```


### WEBサーバの構築
```bash
# 権限変更
chmod 755 web_server_setup.sh

# シェル実行
./web_server_setup.sh
```
