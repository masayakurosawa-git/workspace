
# ロードバランサー設定
### 設定追加(WEBサーバ)
```bash
# php接続で使用していたファイルを退避
sudo mv /etc/httpd/conf.d/php-fpm.conf /etc/httpd/conf.d/php-fpm.conf.bk


# ロードバランサー設定追加
sudo vi /etc/httpd/conf.d/loadbalancer.conf
-----------------------------------------------------
<Proxy "balancer://phpcluster">
#    BalancerMember "fcgi://172.31.3.175:9000"
#    BalancerMember "fcgi://172.31.46.106:9000"
    BalancerMember "fcgi://ap-01.wp.local:9000"
    BalancerMember "fcgi://ap-02.wp.local:9000"
    ProxySet lbmethod=byrequests
</Proxy>

<FilesMatch \.php$>
    SetHandler "proxy:balancer://phpcluster"
</FilesMatch>
-----------------------------------------------------


# 設定反映
sudo systemctl restart httpd
```


### 1号機停止
```bash
# APサーバ1号機停止
sudo systemctl stop php-fpm
```


### 動作確認
```bash
# 動作確認
# http://<WebサーバのパブリックIP>/info.php
http://52.195.187.63/info.php
```

