# パブリックサブネット
外部と通信できる。
ルーティングテーブルにインターネットゲートウェイへの道筋を示しているサブネット。

# プライベートサブネット
内側のみで通信できる。
ルーティングテーブルにインターネットゲートウェイへの道筋を示されていないサブネット。
中からsshすれば良い。



パブリックサブネットのEC2を踏み台にして、プライベートサブネットのEC2にsshする。

</br>
</br>
</br>
</br>


# 手順
### ec2接続(AP)
```bash
# 踏台サーバ(DNS)
ssh -i ~/.ssh/entrycl_202601.pem ec2-user@52.88.252.72 
# APサーバ
ssh -i ~/.ssh/entrycl_202601.pem ec2-user@172.31.255.75
```
</br>


### ec2接続(DB)
```bash
# 踏台サーバ(DNS)
ssh -i ~/.ssh/entrycl_202601.pem ec2-user@52.88.252.72 
# DBサーバ
ssh -i ~/.ssh/entrycl_202601.pem ec2-user@172.31.255.59
```
</br>

### プロンプト
```bash
【役割】
AIに「あなたは経験豊富なインフラエンジニアです」のように役割を与える。

【システム構成】
VPC
 ┣ PublicSubnet
 ┃  ┗ EC2(WEB)
 ┃  ┗ EC2(DNS)
 ┗ PrivateSubnet
    ┗ EC2(PHP)
    ┗ EC2(DB)

【目的】
既存Webサイトの「セキュリティ強化とパフォーマンス改善」を目的とした改修作業

【環境】
・AmazonLinux2023
```

```bash
sudo vi /etc/php-fpm.d/www.conf
--------------------------------
request_terminate_timeout = 30s
--------------------------------
```

```bash
sudo sed -i 's/;date.timezone =/date.timezone = Asia\/Tokyo/' /etc/php.ini
```

```bash
sudo cp -a /var/www/html/wp-config.php /var/www/html/wp-config.php.bak.$(date +%F_%H%M%S)
```

```bash
# バックアップ
sudo cp -a /var/www/html/wp-config.php /var/www/html/wp-config.php.bak.$(date +%F_%H%M%S)

# wp-config.php を修正
sudo vi /var/www/html/wp-config.php
--------------------------------
define( 'DB_HOST', getenv('DB_HOST') ?: 'db.internal.local' );
--------------------------------
```




### 
